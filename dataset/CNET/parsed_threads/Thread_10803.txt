<s> I don't require a solution to this problem anymore, but since I couldn't find help with this issue anywhere on the internet, I thought I'd post the problem and the solution here, in case someone else might find it useful. </s>
<s> I've got five computers linked via a three different switches and an ADSL router. </s>
<s> The reason for this complicated setup is that for various reasons, some of the computers has to be on certain IPs and IP ranges. </s>
<s> Some are on different switches to avoid conflicts, others are on a different switch to seperate them from the rest of the network that has full internet access, because their connection is managed by hotspot software. </s>
<s> The three &quot;office&quot; computers are running Windows XP Service Pack 3, while two others (Points of Sale) are running a custom version of Windows supplied by the Point of Sale company. </s>
<s> Despite all of this, file and printer sharing worked perfectly until we decided to enable Internet Connection Sharing on the main office computer. </s>
<s> Why we did that when we have a router is complicated, but suffice it to say that it was the most elegant solution to a problem where we wanted to provide internet access to the two Point of Sale computers, but still limit their access to the rest of the network (thereby avoiding several IP conflicts). </s>
<s> The main office computer has two network cards, one used to access the internet and the rest of the office computers, the other accesses the Point of Sale part of the network. </s>
<s> Problem was, the moment ICS was enabled, File and Printer Sharing between the main office computer and the Points of Sale continued without problems, but the rest of the office network could not access files on the main computer anymore. </s>
<s> The errors were both the &quot;Network path not found&quot; and the &quot;You do not have permission...&quot; ones. </s>
<s> The strangest part of the problem was that the main computer could still access files on the rest of the office network! </s>
<s> After trying a huge variety of tactics to bring File & Printer Sharing to functionality again, I finally stumbled onto the fact that Windows Firewall was interfering, and cutting off the connection requests. </s>
<s> The Firewall log confirmed this. </s>
<s> I double-checked, and &quot;File and Printer Sharing&quot; was indeed still one of the elements listed under the Exceptions tab. </s>
<s> Not wanting to leave the firewall disabled, I started poking around for solutions. </s>
<s> Finally I got it to work by editing the &quot;File and Printer Sharing&quot; exception under Windows Firewall options, and changing the scope from &quot;My Network (Subnet) Only&quot; to &quot;Custom&quot; and entering the IP addresses of all the computers on the network. </s>
<s> I saved this, and it Windows Firewall stopped dropping the other computers' connection requests. </s>
<s> Here is a portion of the firewall log: #Version: 1.5 #Software: Microsoft Windows Firewall #Time Format: Local #Fields: date time action protocol src-ip dst-ip src-port dst-port size tcpflags tcpsyn tcpack tcpwin icmptype icmpcode info path 2009-12-17 16:40:12 DROP TCP 192.168.1.5 192.168.1.4 1455 139 52 S 2262078089 0 65535 - - - RECEIVE 2009-12-17 16:40:18 DROP TCP 192.168.1.5 192.168.1.4 1455 139 52 S 2262078089 0 65535 - - - RECEIVE 2009-12-17 16:41:08 OPEN TCP 192.168.1.4 192.168.1.5 139 1453 - - - - - - - - - 2009-12-17 16:41:18 CLOSE TCP 192.168.1.4 192.168.1.5 139 1453 - - - - - - - - - 2009-12-17 16:43:19 DROP UDP 192.168.1.5 192.168.1.255 138 138 235 - - - - - - - RECEIVE 2009-12-17 16:43:21 DROP UDP 192.168.1.5 192.168.1.255 138 138 235 - - - - - - - RECEIVE 2009-12-17 16:46:07 DROP UDP 192.168.1.7 192.168.1.255 138 138 229 - - - - - - - RECEIVE 2009-12-17 16:47:50 DROP UDP 192.168.1.7 192.168.1.255 138 138 234 - - - - - - - RECEIVE 2009-12-17 16:48:10 DROP UDP 192.168.1.5 192.168.1.255 138 138 202 - - - - - - - RECEIVE 2009-12-17 16:55:45 DROP UDP 192.168.1.5 192.168.1.255 137 137 78 - - - - - - - RECEIVE 2009-12-17 16:58:08 DROP UDP 192.168.1.7 192.168.1.255 138 138 229 - - - - - - - RECEIVE 2009-12-17 16:58:21 DROP UDP 192.168.1.5 192.168.1.255 138 138 235 - - - - - - - RECEIVE 2009-12-17 16:59:25 OPEN UDP 192.168.1.4 192.168.1.5 137 137 - - - - - - - - - 2009-12-17 16:59:25 OPEN-INBOUND TCP 192.168.1.5 192.168.1.4 1506 139 - - - - - - - - - 2009-12-17 17:00:43 CLOSE UDP 192.168.1.4 192.168.1.5 137 137 - - - - - - - - - 2009-12-17 17:07:32 OPEN UDP 192.168.1.4 192.168.1.5 137 137 - - - - - - - - - 2009-12-17 17:07:34 OPEN TCP 192.168.1.4 192.168.1.5 1273 139 - - - - - - - - - 2009-12-17 17:07:34 OPEN TCP 192.168.0.3 192.168.0.1 1274 139 - - - - - - - - - 2009-12-17 17:07:34 OPEN TCP 192.168.1.4 192.168.1.5 1275 445 - - - - - - - - - 2009-12-17 17:07:34 OPEN TCP 192.168.1.4 192.168.1.5 1276 139 - - - - - - - - - 2009-12-17 17:07:34 CLOSE TCP 192.168.1.4 192.168.1.5 1276 139 - - - - - - - - - Incidentally, after typing in the IP addresses normally and saving it, they were changed to the following format: 192.168.1.5/255.255.255.255. </s>
<s> I'm not sure if the last part is supposed to be the subnet mask (for which we're using 255.255.255.0) but it works - and 255.255.255.0 doesn't. </s>
<s> Which could explain why the &quot;My Network (Subnet) Only&quot; option stopped working - I just don't know why ICS would cause such a change. </s>
<s> Is there anyone out there that can tell us? </s>
<s> Enabling ICS does turn on the firewall so no big surprise here. </s>
<s> There are many articles about it so I'll just write &quot;Yes, it does that.&quot; Bob </s>
<s> Windows Firewall had always been active on that system before, too. </s>
<s> That, in itself, was not the cause of the problem. </s>
<s> Your post seems to point at that and I have seen it change the firewall rules when we turn on ICS. </s>
<s> There is much written about ICS which is why I'll keep my replies short except to agree with you. </s>
<s> ICS tends to be a tarpit of support and what IT staffers learn over time is to not use it. </s>
<s> Bob </s>
<s> I just wanted to post the specific details of the occurence somewhere so that someone else having the same problem could pick it up on a google search - because, as I said, my own google search turned up no specific advice. </s>
