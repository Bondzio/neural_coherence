Training...!
INFORMATION: dropout_ratio=0.5 filter-nb=150 w_size=6 pool_len=6 minibatch-size=32 maxlen=200 emb_size=100
----------------------------------------------------------------------
Loading vocab of the whole dataset...
Using features: [1, 3, 7]
Total vocabulary size in the whole dataset: 19
{'OF10F30F70': 20021, 'OF10F30F71': 1324, 'OF11F30F70': 4443, 'SF11F30F70': 2666, 'XF11F30F70': 11192, 'XF11F31F70': 2757, 'OF11F31F70': 253, 'XF10F31F71': 208, 'XF10F30F71': 3947, 'XF10F30F70': 75647, 'SF11F31F70': 973, '-': 2255398, 'OF10F31F71': 6, 'OF10F31F70': 2007, 'SF10F30F70': 27797, 'SF10F30F71': 1211, 'XF10F31F70': 55871, 'SF10F31F71': 17, 'SF10F31F70': 15717}
loading entity-gird for pos and neg documents...
.....................................
Num of traing pairs: 59
Num of dev pairs: 39
Num of test pairs: 19
Num of permutation in train: 20
The maximum in length for CNN: 200
.....................................
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
sent_input (InputLayer)          (None, 200)           0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)          (None, 200, 100)      2000        sent_input[0][0]                 
____________________________________________________________________________________________________
convolution1d_1 (Convolution1D)  (None, 195, 150)      90150       embedding_1[0][0]                
____________________________________________________________________________________________________
maxpooling1d_1 (MaxPooling1D)    (None, 32, 150)       0           convolution1d_1[0][0]            
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 32, 150)       0           maxpooling1d_1[0][0]             
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 4800)          0           dropout_1[0][0]                  
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 4800)          0           flatten_1[0][0]                  
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 1)             4801        dropout_2[0][0]                  
====================================================================================================
Total params: 96,951
Trainable params: 96,951
Non-trainable params: 0
____________________________________________________________________________________________________
None
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
pos_input (InputLayer)           (None, 200)           0                                            
____________________________________________________________________________________________________
neg_input (InputLayer)           (None, 200)           0                                            
____________________________________________________________________________________________________
model_1 (Model)                  (None, 1)             96951       pos_input[0][0]                  
                                                                   neg_input[0][0]                  
____________________________________________________________________________________________________
coherence_out (Merge)            (None, 2)             0           model_1[1][0]                    
                                                                   model_1[2][0]                    
====================================================================================================
Total params: 96,951
Trainable params: 96,951
Non-trainable params: 0
____________________________________________________________________________________________________
None
------------------------------------------------
Model name: saved_models/Ext_CNN.20_0.5_100_200_6_150_6_32_F.1.3.7
Training model...
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.9995
 -Dev Wins: 5 Ties: 0
 -Dev acc: 0.128205128205
59/59 [==============================] - 1s - loss: 0.9977 - val_loss: 1.0016
Perform on test set after Epoch: 1...!
 -Wins: 8 Ties: 0
 -Test acc: 0.421052631579
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.9816
 -Dev Wins: 20 Ties: 0
 -Dev acc: 0.512820512821
59/59 [==============================] - 0s - loss: 0.9870 - val_loss: 0.9994
Perform on test set after Epoch: 2...!
 -Wins: 4 Ties: 0
 -Test acc: 0.210526315789
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.9845
 -Dev Wins: 11 Ties: 0
 -Dev acc: 0.282051282051
59/59 [==============================] - 0s - loss: 0.9631 - val_loss: 1.0017
Perform on test set after Epoch: 3...!
 -Wins: 16 Ties: 0
 -Test acc: 0.842105263158
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.9142
 -Dev Wins: 9 Ties: 0
 -Dev acc: 0.230769230769
59/59 [==============================] - 0s - loss: 0.8887 - val_loss: 1.0043
Perform on test set after Epoch: 4...!
 -Wins: 8 Ties: 0
 -Test acc: 0.421052631579
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.8640
 -Dev Wins: 10 Ties: 0
 -Dev acc: 0.25641025641
59/59 [==============================] - 0s - loss: 0.8299 - val_loss: 1.0081
Perform on test set after Epoch: 5...!
 -Wins: 11 Ties: 0
 -Test acc: 0.578947368421
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.6973
 -Dev Wins: 10 Ties: 0
 -Dev acc: 0.25641025641
59/59 [==============================] - 0s - loss: 0.6837 - val_loss: 1.0138
Perform on test set after Epoch: 6...!
 -Wins: 11 Ties: 0
 -Test acc: 0.578947368421
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.5655
 -Dev Wins: 12 Ties: 0
 -Dev acc: 0.307692307692
59/59 [==============================] - 0s - loss: 0.5411 - val_loss: 1.0144
Perform on test set after Epoch: 7...!
 -Wins: 8 Ties: 0
 -Test acc: 0.421052631579
Train on 59 samples, validate on 39 samples
Epoch 1/1
32/59 [===============>..............] - ETA: 0s - loss: 0.3897
 -Dev Wins: 17 Ties: 0
 -Dev acc: 0.435897435897
59/59 [==============================] - 0s - loss: 0.3422 - val_loss: 1.0058
Perform on test set after Epoch: 8...!
 -Wins: 8 Ties: 0
 -Test acc: 0.421052631579
Model reachs the best performance on Dev set: 0.435897435897 after: 8epochs
Finish training and testing...
----------------------------------------------------------------------
