Doesn't the XP Files and Settings Transfer Wizard do this?
Not the OS, but programs and stuff.
