Thanks guys!
I managed to fix it!
I downloaded AOMEI Partition Assistant, and tried to merge D with the unallocated space, It spent about half an hour merging them before giving me an error that it couldn't assign the partition a letter.
So I rebooted and reassigned the partition the letter D, but it still showed it as 300gb missing.
But then I went into windows management and the option to extend the drive was no longer greyed out!
I used that and it worked!
